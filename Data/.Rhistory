library(MASS)
library("dplyr")
library("ggpubr")
library(readxl)
coviddata = read_excel("coviddata.xlsx")
# Plotting Tumoursize over months with different subjects coloured, shows that
# subjects are independent ???
(colour_plot <- ggplot(oncdata, aes(x = Months, y = TumourSize, colour = Stage)) +
geom_point(size = 2) +
theme_classic() +
theme(legend.position = "none"))
# --- Preparation --- #
library(mle4)
library(jtools)
library(lmerTest)
library(ggplot2)
library(ggeffects)
# Setting Working Directory
setwd("D:/Skola/KTH/CM2009 - Statistics in Medical Engineering/Git/Data")
# Reading in required libraries
oncdata = read.csv(file = "oncdata.csv", head = TRUE , sep=",")
attach(oncdata)
# Creating model of how TumourSize depens on Months passed
basic.lm <- lm(TumourSize ~ Months, data = oncdata)
summary(basic.lm)
# Plotting said model
(prelim_plot <- ggplot(oncdata, aes(x = Months, y = TumourSize)) +
geom_point() +
geom_smooth(method = "lm"))
# Plotting the residuals
plot(basic.lm, which = 1)
# Showing that boths Stage and Treatment are depending variables
boxplot(TumourSize ~ Stage , data = oncdata)
boxplot(TumourSize ~ Treatment, data = oncdata)
# Showing tha subject is an independent variable which we need to control for
boxplot(TumourSize ~ Subject, data = oncdata)
summary(Stage)
size(Stage)
len(Stage)
# Plotting Tumoursize over months with different subjects coloured, shows that
# subjects are independent ???
(colour_plot <- ggplot(oncdata, aes(x = Months, y = TumourSize, colour = Stage)) +
geom_point(size = 2) +
theme_classic() +
theme(legend.position = "none"))
# Mixed-effects model
fit1_nested_model = lmer(TumourSize ~ 1 + Months + Treatment + ( 1 | Subject/Stage) , data = oncdata)
# Mixed-effects model
fit1_nested_model = lmer(TumourSize ~ 1 + Months + Treatment + ( 1 | Stage/Subject) , data = oncdata)
summary(fit1_nested_model)
summ(fit1_nested_model)
ranova(fit1_nested_model)
# Mixed-effects model
fit1_nested_model = lmer(TumourSize ~ 1 + Months + Treatment + ( 1 | Stage/Subject) , data = oncdata)
fit1_model_reduced = lmer(TumourSize ~  1 + Months + Treatment + (1 | Subject)  , data = oncdata)
fit2_model = lmer(TumourSize ~  1 + Months + Treatment + Stage + ( 1 | Subject)  , data = oncdata)
fit2_model_reduced = lmer(TumourSize ~  1 + Months + Treatment + (1 | Subject)  , data = oncdata)
ranova(fit1_model, fit1_nested_model, fit2_model, fit2_model_reduced)
anova(fit1_model, fit1_nested_model, fit2_model, fit2_model_reduced)
fit1_model = lmer(TumourSize ~  1 + Months + Treatment + (1 | Subject)  , data = oncdata)
anova(fit1_model, fit1_nested_model, fit2_model, fit2_model_reduced)
# Model 2
summary(fit2_model) # default lme4
plot(oncdata)
anova(fit1_model, fit1_nested_model, fit2_model, fit2_model_reduced)
# Model 1 - NESTED
summary(fit1_nested_model) # default lme4
summ(fit1_nested_model)    # jtools
ranova(fit1_nested_model)  # lmerTest
# Model 1 - NESTED
summary(fit1_nested_model) # default lme4
summ(fit1_nested_model)    # jtools
ranova(fit1_nested_model)  # lmerTest
# Model 1
summary(fit2_model) # default lme4
AIC(fit1_nested_model)
AIC(fit1_model)
AIC(fit1_nested_model, 3)
AIC(fit1_model, 3)
AIC(fit1_nested_model)
AIC(fit1_model)
AIC(fit2_model)
AIC(fit2_model,3)
# Mixed-effects model
fit1_model = lmer(TumourSize ~ 1 + Months + Treatment + ( 1 | Stage/Subject)  , data = oncdata)
fit2_model = lmer(TumourSize ~  1 + Months + Treatment + Stage + ( 1 | Subject)  , data = oncdata)
fit2_model_reduced = lmer(TumourSize ~  1 + Months + Treatment + (1 | Subject)  , data = oncdata)
anova(fit1_model, fit2_model, fit2_model_reduced)
# Creating model of how TumourSize depens on Months passed
basic.lm <- lm(TumourSize ~ Months, data = oncdata)
summary(basic.lm)
# Plotting said model
(prelim_plot <- ggplot(oncdata, aes(x = Months, y = TumourSize)) +
geom_point() +
geom_smooth(method = "lm"))
